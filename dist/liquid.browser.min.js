!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).liquidjs={})}(this,function(p){"use strict";var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function t(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var R=function(){return(R=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function L(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&(r[n[i]]=t[n[i]])}return r}function s(s,o,a,u){return new(a=a||Promise)(function(t,e){function r(t){try{i(u.next(t))}catch(t){e(t)}}function n(t){try{i(u.throw(t))}catch(t){e(t)}}function i(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(r,n)}i((u=u.apply(s,o||[])).next())})}function D(r,n){var i,s,o,t,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=n.call(r,a)}catch(t){e=[6,t],s=0}finally{i=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function F(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}function y(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||0<e--)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function w(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(y(arguments[e]));return t}var r=(e.prototype.valueOf=function(){},e.prototype.themeConfig=function(){},e.prototype.liquidMethodMissing=function(t){},e);function e(){}var i=Object.prototype.toString,o=String.prototype.toLowerCase;function f(t){return"[object String]"===i.call(t)}function d(t){return"function"==typeof t}function a(t){return c(t=v(t))?"":String(t)}function v(t){return t instanceof r?t.valueOf():t}function u(t){return"number"==typeof t}function c(t){return null==t}function g(t){return"[object Array]"===i.call(t)}function l(t,e){for(var r in t=t||{})if(t.hasOwnProperty(r)&&!1===e(t[r],r,t))break;return t}function h(t){return t[t.length-1]}function m(t){var e=typeof t;return null!==t&&("object"==e||"function"==e)}function b(t,e,r){void 0===r&&(r=1);for(var n=[],i=t;i<e;i+=r)n.push(i);return n}function T(t,e,r){return void 0===r&&(r=" "),k(t,e,r,function(t,e){return e+t})}function k(t,e,r,n){for(var i=e-(t=String(t)).length;0<i--;)t=n(t,r);return t}function x(t){return t}function O(t){return t.replace(/(\w?)([A-Z])/g,function(t,e,r){return(e?e+"_":"")+r.toLowerCase()})}function q(t,e){return null==t&&null==e?0:null==t?1:null==e?-1:(t=o.call(t))<(e=o.call(e))?-1:e<t?1:0}var S=function(t,e,r,n){this.key=t,this.value=e,this.next=r,this.prev=n},E=(N.prototype.write=function(t,e){if(this.cache[t])this.cache[t].value=e;else{var r=new S(t,e,this.head.next,this.head);this.head.next.prev=r,this.head.next=r,this.cache[t]=r,this.size++,this.ensureLimit()}},N.prototype.read=function(t){if(this.cache[t]){var e=this.cache[t].value;return this.remove(t),this.write(t,e),e}},N.prototype.remove=function(t){var e=this.cache[t];e.prev.next=e.next,e.next.prev=e.prev,delete this.cache[t],this.size--},N.prototype.clear=function(){this.head.next=this.tail,this.tail.prev=this.head,this.size=0,this.cache={}},N.prototype.ensureLimit=function(){this.size>this.limit&&this.remove(this.tail.prev.key)},N);function N(t,e){void 0===e&&(e=0),this.limit=t,this.size=e,this.cache={},this.head=new S("HEAD",null,null,null),this.tail=new S("TAIL",null,null,null),this.head.next=this.tail,this.tail.prev=this.head}var P=(I.prototype.getTpl=function(t){return function(t,e){function r(t){for(var e,r=s,n=0;n<t.length;){if(n!==t.length-1){var i=o(r,t[n]);i&&(r=i.data)}if(!r)return;n++}return r&&(e=function(t,e){for(var r=t,n={},i=0;i<r.length;i++)if("file"===r[i].type&&(r[i].name===e||r[i].name===e+".liquid"||r[i].name===e+".json")){n=r[i].data;break}return n&&n.value}(r,t[t.length-1])),e}var s=e,o=function(t,e){for(var r={type:"folder",name:"",data:[]},n=0;n<t.length;n++)if("folder"===t[n].type){if(t[n].name===e){r=t[n];break}o(t[n].data,e)}return r},n={},i=t.split("/");return n=1<i.length?r(i):(n=n||r(["sections"].concat(i)))||r(["snippets"].concat(i))}(t,this.rootData)},I);function I(){var t=window.localStorage.getItem("themeData");if(!t)throw new Error("没有获取到 themeData");this.rootData=JSON.parse(t)}var M=Object.freeze({resolve:function(t,e,r){return e},readFile:function(n){return s(this,void 0,void 0,function(){var e,r;return D(this,function(t){return(e=new P).rootData&&void 0!==(r=e.getTpl(n))?[2,Promise.resolve(r)]:[2,Promise.resolve("没有你的模板: "+n)]})})},readFileSync:function(t){return t},exists:function(t){return s(this,void 0,void 0,function(){return D(this,function(t){return[2,!0]})})},existsSync:function(t){return!0}});function j(t){return t&&d(t.equals)}function A(t,e){return!C(t,e)}function C(t,e){return e.opts.jsTruthy?!t:!1===t||null==t}var V={"==":function(t,e){return j(t)?t.equals(e):j(e)?e.equals(t):t===e},"!=":function(t,e){return j(t)?!t.equals(e):j(e)?!e.equals(t):t!==e},">":function(t,e){return j(t)?t.gt(e):j(e)?e.lt(t):e<t},"<":function(t,e){return j(t)?t.lt(e):j(e)?e.gt(t):t<e},">=":function(t,e){return j(t)?t.geq(e):j(e)?e.leq(t):e<=t},"<=":function(t,e){return j(t)?t.leq(e):j(e)?e.geq(t):t<=e},contains:function(t,e){return!(!t||!d(t.indexOf))&&-1<t.indexOf(e)},and:function(t,e,r){return A(t,r)&&A(e,r)},or:function(t,e,r){return A(t,r)||A(e,r)}},_=[0,0,0,0,0,0,0,0,0,20,4,4,4,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,2,8,0,0,0,0,8,0,0,0,64,0,65,0,0,33,33,33,33,33,33,33,33,33,33,0,0,2,2,2,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0],z=1,B=4,H=16;function U(t){var e,r,n={};try{for(var i=F(Object.entries(t)),s=i.next();!s.done;s=i.next()){for(var o=y(s.value,2),a=o[0],u=o[1],c=n,l=0;l<a.length;l++){var h=a[l];c[h]=c[h]||{},l===a.length-1&&_[a.charCodeAt(l)]&z&&(c[h].needBoundary=!0),c=c[h]}c.handler=u,c.end=!0}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}_[160]=_[5760]=_[6158]=_[8192]=_[8193]=_[8194]=_[8195]=_[8196]=_[8197]=_[8198]=_[8199]=_[8200]=_[8201]=_[8202]=_[8232]=_[8233]=_[8239]=_[8287]=_[12288]=B;var K={root:["."],cache:void 0,extname:"",fs:M,dynamicPartials:!0,jsTruthy:!1,trimTagRight:!1,trimTagLeft:!1,trimOutputRight:!1,trimOutputLeft:!1,greedy:!0,tagDelimiterLeft:"{%",tagDelimiterRight:"%}",outputDelimiterLeft:"{{",outputDelimiterRight:"}}",preserveTimezones:!1,strictFilters:!1,strictVariables:!1,lenientIf:!1,globals:{},keepOutputType:!1,operators:V,operatorsTrie:U(V)};function Q(t){if((t=t||{}).hasOwnProperty("root")&&(t.root=W(t.root)),t.hasOwnProperty("cache")){var e=void 0;e="number"==typeof t.cache?0<t.cache?new E(t.cache):void 0:"object"==typeof t.cache?t.cache:t.cache?new E(1024):void 0,t.cache=e}return t.hasOwnProperty("operators")&&(t.operatorsTrie=U(t.operators)),t}function W(t){return g(t)?t:f(t)?[t]:[]}var J,$=(t(Y,J=Error),Y.prototype.update=function(){var t=this.originalError;this.context=function(t){var e=y(t.getPosition(),1)[0],r=t.input.split("\n"),n=Math.max(e-2,1),i=Math.min(e+3,r.length);return b(n,i+1).map(function(t){return(t===e?">> ":"   ")+T(String(t),String(i).length)+"| "+r[t-1]}).join("\n")}(this.token),this.message=function(t,e){e.file&&(t+=", file:"+e.file);var r=y(e.getPosition(),2),n=r[0],i=r[1];return t+=", line:"+n+", col:"+i}(t.message,this.token),this.stack=this.message+"\n"+this.context+"\n"+this.stack+"\nFrom "+t.stack},Y);function Y(t,e){var r=J.call(this,t.message)||this;return r.originalError=t,r.token=e,r.context="",r}var Z,G=(t(X,Z=$),X);function X(t,e){var r=Z.call(this,new Error(t),e)||this;return r.name="TokenizationError",Z.prototype.update.call(r),r}var tt,et=(t(rt,tt=$),rt);function rt(t,e){var r=tt.call(this,t,e)||this;return r.name="ParseError",r.message=t.message,tt.prototype.update.call(r),r}var nt,it=(t(st,nt=$),st.is=function(t){return"RenderError"===t.name},st);function st(t,e){var r=nt.call(this,t,e.token)||this;return r.name="RenderError",r.message=t.message,nt.prototype.update.call(r),r}var ot,at=(t(ut,ot=$),ut);function ut(t,e){var r=ot.call(this,t,e)||this;return r.name="UndefinedVariableError",r.message=t.message,ot.prototype.update.call(r),r}var ct,lt=(t(ht,ct=Error),ht);function ht(t){var e=ct.call(this,"undefined variable: "+t)||this;return e.name="InternalUndefinedVariableError",e.variableName=t,e}var pt,ft=(t(dt,pt=Error),dt);function dt(t){var e=pt.call(this,t)||this;return e.name="AssertionError",e.message=t+"",e}var vt,gt=(mt.prototype.getRegister=function(t,e){return void 0===e&&(e={}),this.registers[t]=this.registers[t]||e},mt.prototype.setRegister=function(t,e){return this.registers[t]=e},mt.prototype.saveRegister=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.map(function(t){return[t,e.getRegister(t)]})},mt.prototype.restoreRegister=function(t){var i=this;return t.forEach(function(t){var e=y(t,2),r=e[0],n=e[1];return i.setRegister(r,n)})},mt.prototype.getAll=function(){return w([this.globals,this.environments],this.scopes).reduce(function(t,e){return R(t,e)},{})},mt.prototype.get=function(t){var e=this.findScope(t[0]);return this.getFromScope(e,t)},mt.prototype.getFromScope=function(t,e){var n=this;return"string"==typeof e&&(e=e.split(".")),e.reduce(function(t,e){var r=yt(t,e);if(c(t=n.isHexColor(t)&&!r?yt(n.hexToRgba(t),e):r)&&n.opts.strictVariables)throw new lt(e);return t},t)},mt.prototype.push=function(t){return this.scopes.push(t)},mt.prototype.pop=function(){return this.scopes.pop()},mt.prototype.bottom=function(){return this.scopes[0]},mt.prototype.findScope=function(t){for(var e=this.scopes.length-1;0<=e;e--){var r=this.scopes[e];if(t in r)return r}return t in this.environments?this.environments:this.globals},mt.prototype.isHexColor=function(t){return t&&/^#([0-9a-fA-f]{6}|[0-9a-fA-f]{3})$/.test(t)},mt.prototype.hexToRgba=function(t){var e={red:"",green:"",blue:"",alpha:""};if(this.isHexColor(t)){if(4===t.length){for(var r="#",n=1;n<4;n+=1)r+=t.slice(n,n+1).concat(t.slice(n,n+1));t=r}var i=[];for(n=1;n<7;n+=2)i.push(parseInt("0x"+t.slice(n,n+2)));e={red:""+i[0],green:""+i[1],blue:""+i[2],alpha:"1"}}return e},mt);function mt(t,e,r){void 0===t&&(t={}),void 0===e&&(e=K),void 0===r&&(r=!1),this.scopes=[{}],this.registers={},this.sync=r,this.opts=e,this.globals=e.globals,this.environments=t}function yt(t,e){return c(t)?t:d((t=function t(e){return e&&d(e.toLiquid)?t(e.toLiquid()):e}(t))[e])?t[e]():t instanceof r?t.hasOwnProperty(e)?t[e]:t.liquidMethodMissing(e):"size"===e?function(t){return g(t)||f(t)?t.length:t.size}(t):"first"===e?function(t){return g(t)?t[0]:t.first}(t):"last"===e?function(t){return g(t)?t[t.length-1]:t.last}(t):t[e]}function wt(t){return!!(Dt(t)&p.TokenKind.Delimited)}function bt(t){return Dt(t)===p.TokenKind.Operator}function Tt(t){return Dt(t)===p.TokenKind.HTML}function kt(t){return Dt(t)===p.TokenKind.Output}function xt(t){return Dt(t)===p.TokenKind.Tag}function Ot(t){return Dt(t)===p.TokenKind.Quoted}function qt(t){return Dt(t)===p.TokenKind.Literal}function St(t){return Dt(t)===p.TokenKind.Number}function Et(t){return Dt(t)===p.TokenKind.PropertyAccess}function Rt(t){return Dt(t)===p.TokenKind.Word}function Lt(t){return Dt(t)===p.TokenKind.Range}function Dt(t){return t?t.kind:-1}(vt=p.TokenKind||(p.TokenKind={}))[vt.Number=1]="Number",vt[vt.Literal=2]="Literal",vt[vt.Tag=4]="Tag",vt[vt.Output=8]="Output",vt[vt.HTML=16]="HTML",vt[vt.Filter=32]="Filter",vt[vt.Hash=64]="Hash",vt[vt.PropertyAccess=128]="PropertyAccess",vt[vt.Word=256]="Word",vt[vt.Range=512]="Range",vt[vt.Quoted=1024]="Quoted",vt[vt.Operator=2048]="Operator",vt[vt.Delimited=12]="Delimited";var Ft=Object.freeze({isDelimitedToken:wt,isOperatorToken:bt,isHTMLToken:Tt,isOutputToken:kt,isTagToken:xt,isQuotedToken:Ot,isLiteralToken:qt,isNumberToken:St,isPropertyAccessToken:Et,isWordToken:Rt,isRangeToken:Lt});function Nt(t,e){if(t&&Tt(t))for(var r=e?B:H;_[t.input.charCodeAt(t.end-1-t.trimRight)]&r;)t.trimRight++}function Pt(t,e){if(t&&Tt(t)){for(var r=e?B:H;_[t.input.charCodeAt(t.begin+t.trimLeft)]&r;)t.trimLeft++;"\n"===t.input.charAt(t.begin+t.trimLeft)&&t.trimLeft++}}var It=(Mt.prototype.getText=function(){return this.input.slice(this.begin,this.end)},Mt.prototype.getPosition=function(){for(var t=y([1,1],2),e=t[0],r=t[1],n=0;n<this.begin;n++)"\n"===this.input[n]?(e++,r=1):r++;return[e,r]},Mt.prototype.size=function(){return this.end-this.begin},Mt);function Mt(t,e,r,n,i){this.kind=t,this.input=e,this.begin=r,this.end=n,this.file=i}var jt,At=(t(Ct,jt=It),Ct);function Ct(t,e){var r=jt.call(this,p.TokenKind.Number,t.input,t.begin,e?e.end:t.end,t.file)||this;return r.whole=t,r.decimal=e,r}var Vt,_t=(t(zt,Vt=It),zt.prototype.isNumber=function(t){void 0===t&&(t=!1);for(var e=t&&64&_[this.input.charCodeAt(this.begin)]?this.begin+1:this.begin;e<this.end;e++)if(!(32&_[this.input.charCodeAt(e)]))return!1;return!0},zt);function zt(t,e,r,n){var i=Vt.call(this,p.TokenKind.Word,t,e,r,n)||this;return i.input=t,i.begin=e,i.end=r,i.file=n,i.content=i.getText(),i}var Bt,Ht=(t(Ut,Bt=r),Ut.prototype.equals=function(t){return c(v(t))},Ut.prototype.gt=function(){return!1},Ut.prototype.geq=function(){return!1},Ut.prototype.lt=function(){return!1},Ut.prototype.leq=function(){return!1},Ut.prototype.valueOf=function(){return null},Ut);function Ut(){return null!==Bt&&Bt.apply(this,arguments)||this}var Kt,Qt=(t(Wt,Kt=r),Wt.prototype.equals=function(t){return!(t instanceof Wt||(f(t=v(t))||g(t)?0!==t.length:!m(t)||0!==Object.keys(t).length))},Wt.prototype.gt=function(){return!1},Wt.prototype.geq=function(){return!1},Wt.prototype.lt=function(){return!1},Wt.prototype.leq=function(){return!1},Wt.prototype.valueOf=function(){return""},Wt);function Wt(){return null!==Kt&&Kt.apply(this,arguments)||this}var Jt,$t=(t(Yt,Jt=Qt),Yt.prototype.equals=function(t){return!1===t||!!c(v(t))||(f(t)?/^\s*$/.test(t):Jt.prototype.equals.call(this,t))},Yt);function Yt(){return null!==Jt&&Jt.apply(this,arguments)||this}var Zt,Gt=new Ht,Xt={true:!0,false:!1,nil:Gt,null:Gt,empty:new Qt,blank:new $t},te=(t(ee,Zt=It),ee);function ee(t,e,r,n){var i=Zt.call(this,p.TokenKind.Literal,t,e,r,n)||this;return i.input=t,i.begin=e,i.end=r,i.file=n,i.literal=i.getText(),i}var re,ne={"==":1,"!=":1,">":1,"<":1,">=":1,"<=":1,contains:1,and:0,or:0},ie=(t(se,re=It),se.prototype.getPrecedence=function(){var t=this.getText();return t in ne?ne[t]:1},se);function se(t,e,r,n){var i=re.call(this,p.TokenKind.Operator,t,e,r,n)||this;return i.input=t,i.begin=e,i.end=r,i.file=n,i.operator=i.getText(),i}var oe=/[\da-fA-F]/,ae=/[0-7]/,ue={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v"};function ce(t){var e=t.charCodeAt(0);return 97<=e?e-87:65<=e?e-55:e-48}function le(t){for(var e="",r=1;r<t.length-1;r++)if("\\"===t[r])if(void 0!==ue[t[r+1]])e+=ue[t[++r]];else if("u"===t[r+1]){for(var n=0,i=r+2;i<=r+5&&oe.test(t[i]);)n=16*n+ce(t[i++]);r=i-1,e+=String.fromCharCode(n)}else if(ae.test(t[r+1])){for(i=r+1,n=0;i<=r+3&&ae.test(t[i]);)n=8*n+ce(t[i++]);r=i-1,e+=String.fromCharCode(n)}else e+=t[++r];else e+=t[r];return e}var he,pe=(t(fe,he=It),fe.prototype.getVariableAsText=function(){return this.variable instanceof _t?this.variable.getText():le(this.variable.getText())},fe);function fe(t,e,r){var n=he.call(this,p.TokenKind.PropertyAccess,t.input,t.begin,r,t.file)||this;return n.variable=t,n.props=e,n}function de(t,e){if(!t){var r=e?e():"expect "+t+" to be true";throw new ft(r)}}var ve,ge=(t(me,ve=It),me);function me(t,e,r,n,i,s){var o=ve.call(this,p.TokenKind.Filter,r,n,i,s)||this;return o.name=t,o.args=e,o}var ye,we=(t(be,ye=It),be);function be(t,e,r,n,i,s){var o=ye.call(this,p.TokenKind.Hash,t,e,r,s)||this;return o.input=t,o.begin=e,o.end=r,o.name=n,o.value=i,o.file=s,o}var Te,ke=(t(xe,Te=It),xe);function xe(t,e,r,n){var i=Te.call(this,p.TokenKind.Quoted,t,e,r,n)||this;return i.input=t,i.begin=e,i.end=r,i.file=n,i}var Oe,qe=(t(Se,Oe=It),Se.prototype.getContent=function(){return this.input.slice(this.begin+this.trimLeft,this.end-this.trimRight)},Se);function Se(t,e,r,n){var i=Oe.call(this,p.TokenKind.HTML,t,e,r,n)||this;return i.input=t,i.begin=e,i.end=r,i.file=n,i.trimLeft=0,i.trimRight=0,i}var Ee,Re=(t(Le,Ee=It),Le);function Le(t,e,r,n,i,s,o,a){var u=Ee.call(this,t,r,n,i,a)||this;u.trimLeft=!1,u.trimRight=!1,u.content=u.getText();var c="-"===e[0],l="-"===h(e);return u.content=e.slice(c?1:0,l?-1:e.length).trim(),u.trimLeft=c||s,u.trimRight=l||o,u}var De,Fe=(t(Ne,De=Re),Ne);function Ne(t,e,r,n,i){var s=this,o=n.trimTagLeft,a=n.trimTagRight,u=n.tagDelimiterLeft,c=n.tagDelimiterRight,l=t.slice(e+u.length,r-c.length);s=De.call(this,p.TokenKind.Tag,l,t,e,r,o,a,i)||this;var h=new He(s.content,n.operatorsTrie);if(s.name=h.readIdentifier().getText(),!s.name)throw new G("illegal tag syntax",s);return h.skipBlank(),s.args=h.remaining(),s}var Pe,Ie=(t(Me,Pe=It),Me);function Me(t,e,r,n,i,s){var o=Pe.call(this,p.TokenKind.Range,t,e,r,s)||this;return o.input=t,o.begin=e,o.end=r,o.lhs=n,o.rhs=i,o.file=s,o}var je,Ae=(t(Ce,je=Re),Ce);function Ce(t,e,r,n,i){var s=n.trimOutputLeft,o=n.trimOutputRight,a=n.outputDelimiterLeft,u=n.outputDelimiterRight,c=t.slice(e+a.length,r-u.length);return je.call(this,p.TokenKind.Output,c,t,e,r,s,o,i)||this}var Ve=(_e.prototype.evaluate=function(e,r){var n,i,s,o,a,u,c,l,h,p,f,d;return D(this,function(t){switch(t.label){case 0:de(e,function(){return"unable to evaluate: context not defined"}),n=[],t.label=1;case 1:t.trys.push([1,9,10,11]),i=F(this.postfix),s=i.next(),t.label=2;case 2:return s.done?[3,8]:bt(o=s.value)?[4,n.pop()]:[3,5];case 3:return a=t.sent(),[4,n.pop()];case 4:return u=t.sent(),c=function(t,e,r,n,i){return(0,t[e.operator])(r,n,i)}(e.opts.operators,o,u,a,e),n.push(c),[3,7];case 5:return h=(l=n).push,[4,ze(o,e,r&&1===this.postfix.length)];case 6:h.apply(l,[t.sent()]),t.label=7;case 7:return s=i.next(),[3,2];case 8:return[3,11];case 9:return p=t.sent(),f={error:p},[3,11];case 10:try{s&&!s.done&&(d=i.return)&&d.call(i)}finally{if(f)throw f.error}return[7];case 11:return[2,n[0]]}})},_e);function _e(t){this.postfix=w(function(e){var r,n,i,s,o,a,u;return D(this,function(t){switch(t.label){case 0:r=[],t.label=1;case 1:t.trys.push([1,10,11,12]),n=F(e),i=n.next(),t.label=2;case 2:if(i.done)return[3,9];if(!bt(s=i.value))return[3,6];t.label=3;case 3:return r.length&&r[r.length-1].getPrecedence()>s.getPrecedence()?[4,r.pop()]:[3,5];case 4:return t.sent(),[3,3];case 5:return r.push(s),[3,8];case 6:return[4,s];case 7:t.sent(),t.label=8;case 8:return i=n.next(),[3,2];case 9:return[3,12];case 10:return o=t.sent(),a={error:o},[3,12];case 11:try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(a)throw a.error}return[7];case 12:return r.length?[4,r.pop()]:[3,14];case 13:return t.sent(),[3,12];case 14:return[2]}})}(t))}function ze(t,e,r){return void 0===r&&(r=!1),Et(t)?function(e,r,n){var t=e.getVariableAsText(),i=e.props.map(function(t){return ze(t,r,!1)});try{return r.get(w([t],i))}catch(t){if(n&&"InternalUndefinedVariableError"===t.name)return null;throw new at(t,e)}}(t,e,r):Lt(t)?function(t,e){var r=ze(t.lhs,e),n=ze(t.rhs,e);return b(+r,+n+1)}(t,e):qt(t)?function(t){return Xt[t.literal]}(t):St(t)?function(t){var e=t.whole.content+"."+(t.decimal?t.decimal.content:"");return Number(e)}(t):Rt(t)?t.getText():Ot(t)?Be(t):void 0}function Be(t){return le(t.getText())}var He=(Ue.prototype.readExpression=function(){return new Ve(this.readExpressionTokens())},Ue.prototype.readExpressionTokens=function(){var e,r,n;return D(this,function(t){switch(t.label){case 0:return(e=this.readValue())?[4,e]:[2];case 1:t.sent(),t.label=2;case 2:return this.p<this.N?(r=this.readOperator())&&(n=this.readValue())?[4,r]:[2]:[3,5];case 3:return t.sent(),[4,n];case 4:return t.sent(),[3,2];case 5:return[2]}})},Ue.prototype.readOperator=function(){this.skipBlank();var t=function(t,e,r,n){void 0===n&&(n=t.length);for(var i,s=r,o=e;s[t[o]]&&o<n;)(s=s[t[o++]]).end&&(i=s);return i?i.needBoundary&&_[t.charCodeAt(o)]&z?-1:o:-1}(this.input,this.p,this.trie,this.p+8);if(-1!==t)return new ie(this.input,this.p,this.p=t,this.file)},Ue.prototype.readFilters=function(){for(var t=[];;){var e=this.readFilter();if(!e)return t;t.push(e)}},Ue.prototype.readFilter=function(){var t=this;if(this.skipBlank(),this.end())return null;de("|"===this.peek(),function(){return"unexpected token at "+t.snapshot()}),this.p++;var e=this.p,r=this.readIdentifier();if(!r.size())return null;var n=[];if(this.skipBlank(),":"===this.peek())do{++this.p;var i=this.readFilterArg();for(i&&n.push(i);this.p<this.N&&","!==this.peek()&&"|"!==this.peek();)++this.p}while(","===this.peek());return new ge(r.getText(),n,this.input,e,this.p,this.file)},Ue.prototype.readFilterArg=function(){var t=this.readValue();if(t){if(this.skipBlank(),":"!==this.peek())return t;++this.p;var e=this.readValue();return[t.getText(),e]}},Ue.prototype.readTopLevelTokens=function(t){void 0===t&&(t=K);for(var e=[];this.p<this.N;){var r=this.readTopLevelToken(t);e.push(r)}return function(t,e){for(var r=!1,n=0;n<t.length;n++){var i=t[n];wt(i)&&(!r&&i.trimLeft&&Nt(t[n-1],e.greedy),xt(i)&&("raw"===i.name?r=!0:"endraw"===i.name&&(r=!1)),!r&&i.trimRight&&Pt(t[n+1],e.greedy))}}(e,t),e},Ue.prototype.readTopLevelToken=function(t){var e=t.tagDelimiterLeft,r=t.outputDelimiterLeft;return-1<this.rawBeginAt?this.readEndrawOrRawContent(t):this.match(e)?this.readTagToken(t):this.match(r)?this.readOutputToken(t):this.readHTMLToken(t)},Ue.prototype.readHTMLToken=function(t){for(var e=this.p;this.p<this.N;){var r=t.tagDelimiterLeft,n=t.outputDelimiterLeft;if(this.match(r))break;if(this.match(n))break;++this.p}return new qe(this.input,e,this.p,this.file)},Ue.prototype.readTagToken=function(t){void 0===t&&(t=K);var e=this.file,r=this.input,n=this.p;if(-1===this.readToDelimiter(t.tagDelimiterRight))throw this.mkError("tag "+this.snapshot(n)+" not closed",n);var i=new Fe(r,n,this.p,t,e);return"raw"===i.name&&(this.rawBeginAt=n),i},Ue.prototype.readToDelimiter=function(t){for(;this.p<this.N;)if(8&this.peekType())this.readQuoted();else if(++this.p,this.rmatch(t))return this.p;return-1},Ue.prototype.readOutputToken=function(t){void 0===t&&(t=K);var e=this.file,r=this.input,n=t.outputDelimiterRight,i=this.p;if(-1===this.readToDelimiter(n))throw this.mkError("output "+this.snapshot(i)+" not closed",i);return new Ae(r,i,this.p,t,e)},Ue.prototype.readEndrawOrRawContent=function(t){for(var e=t.tagDelimiterLeft,r=t.tagDelimiterRight,n=this.p,i=this.readTo(e)-e.length;this.p<this.N;)if("endraw"===this.readIdentifier().getText())for(;this.p<=this.N;){if(this.rmatch(r)){var s=this.p;return n===i?(this.rawBeginAt=-1,new Fe(this.input,n,s,t,this.file)):(this.p=i,new qe(this.input,n,i,this.file))}if(this.rmatch(e))break;this.p++}else i=this.readTo(e)-e.length;throw this.mkError("raw "+this.snapshot(this.rawBeginAt)+" not closed",n)},Ue.prototype.mkError=function(t,e){return new G(t,new _t(this.input,e,this.N,this.file))},Ue.prototype.snapshot=function(t){return void 0===t&&(t=this.p),JSON.stringify(function(t,e){return t.length>e?t.substr(0,e-3)+"...":t}(this.input.slice(t),16))},Ue.prototype.readWord=function(){return console.warn("Tokenizer#readWord() will be removed, use #readIdentifier instead"),this.readIdentifier()},Ue.prototype.readIdentifier=function(){this.skipBlank();for(var t=this.p;this.peekType()&z;)++this.p;return new _t(this.input,t,this.p,this.file)},Ue.prototype.readHashes=function(){for(var t=[];;){var e=this.readHash();if(!e)return t;t.push(e)}},Ue.prototype.readHash=function(){this.skipBlank(),","===this.peek()&&++this.p;var t,e=this.p,r=this.readIdentifier();if(r.size())return this.skipBlank(),":"===this.peek()&&(++this.p,t=this.readValue()),new we(this.input,e,this.p,r,t,this.file)},Ue.prototype.remaining=function(){return this.input.slice(this.p)},Ue.prototype.advance=function(t){void 0===t&&(t=1),this.p+=t},Ue.prototype.end=function(){return this.p>=this.N},Ue.prototype.readTo=function(t){for(;this.p<this.N;)if(++this.p,this.rmatch(t))return this.p;return-1},Ue.prototype.readValue=function(){var t=this.readQuoted()||this.readRange();if(t)return t;if("["===this.peek()){if(this.p++,!(i=this.readQuoted()))return;if("]"!==this.peek())return;return this.p++,new pe(i,[],this.p)}var e=this.readIdentifier();if(e.size()){for(var r=e.isNumber(!0),n=[];;)if("["===this.peek()){r=!1,this.p++;var i=this.readValue()||new _t(this.input,this.p,this.p,this.file);this.readTo("]"),n.push(i)}else{if("."!==this.peek()||"."===this.peek(1))break;if(this.p++,!(i=this.readIdentifier()).size())break;i.isNumber()||(r=!1),n.push(i)}return!n.length&&Xt.hasOwnProperty(e.content)?new te(this.input,e.begin,e.end,this.file):r?new At(e,n[0]):new pe(e,n,this.p)}},Ue.prototype.readRange=function(){this.skipBlank();var t=this.p;if("("===this.peek()){++this.p;var e=this.readValueOrThrow();this.p+=2;var r=this.readValueOrThrow();return++this.p,new Ie(this.input,t,this.p,e,r,this.file)}},Ue.prototype.readValueOrThrow=function(){var t=this,e=this.readValue();return de(e,function(){return"unexpected token "+t.snapshot()+", value expected"}),e},Ue.prototype.readQuoted=function(){this.skipBlank();var t=this.p;if(8&this.peekType()){++this.p;for(var e=!1;this.p<this.N&&(++this.p,this.input[this.p-1]!==this.input[t]||e);)e?e=!1:"\\"===this.input[this.p-1]&&(e=!0);return new ke(this.input,t,this.p,this.file)}},Ue.prototype.readFileName=function(){for(var t=this.p;!(this.peekType()&B)&&","!==this.peek()&&this.p<this.N;)this.p++;return new _t(this.input,t,this.p,this.file)},Ue.prototype.match=function(t){for(var e=0;e<t.length;e++)if(t[e]!==this.input[this.p+e])return!1;return!0},Ue.prototype.rmatch=function(t){for(var e=0;e<t.length;e++)if(t[t.length-1-e]!==this.input[this.p-1-e])return!1;return!0},Ue.prototype.peekType=function(t){return void 0===t&&(t=0),_[this.input.charCodeAt(this.p+t)]},Ue.prototype.peek=function(t){return void 0===t&&(t=0),this.input[this.p+t]},Ue.prototype.skipBlank=function(){for(;this.peekType()&B;)++this.p},Ue);function Ue(t,e,r){void 0===r&&(r=""),this.input=t,this.trie=e,this.file=r,this.p=0,this.rawBeginAt=-1,this.N=t.length}var Ke=(Qe.prototype.write=function(t){t=!0===this.keepOutputType?v(t):a(v(t)),!0===this.keepOutputType&&"string"!=typeof t&&""===this.html?this.html=t:this.html=a(this.html)+a(t)},Qe);function Qe(t){this.html="",this.break=!1,this.continue=!1,this.keepOutputType=!1,this.keepOutputType=t}var We=(Je.prototype.renderTemplates=function(e,r,n){var i,s,o,a,u,c,l,h;return D(this,function(t){switch(t.label){case 0:n=n||new Ke(r.opts.keepOutputType),t.label=1;case 1:t.trys.push([1,8,9,10]),i=F(e),s=i.next(),t.label=2;case 2:if(s.done)return[3,7];o=s.value,t.label=3;case 3:return t.trys.push([3,5,,6]),[4,o.render(r,n)];case 4:return(a=t.sent())&&n.write(a),n.break||n.continue?[3,7]:[3,6];case 5:throw u=t.sent(),it.is(u)?u:new it(u,o);case 6:return s=i.next(),[3,2];case 7:return[3,10];case 8:return c=t.sent(),l={error:c},[3,10];case 9:try{s&&!s.done&&(h=i.return)&&h.call(i)}finally{if(l)throw l.error}return[7];case 10:return[2,n.html]}})},Je);function Je(){}var $e=(Ye.prototype.on=function(t,e){return this.handlers[t]=e,this},Ye.prototype.trigger=function(t,e){var r=this.handlers[t];return!!r&&(r(e),!0)},Ye.prototype.start=function(){var t;for(this.trigger("start");!this.stopRequested&&(t=this.tokens.shift());)if(!(this.trigger("token",t)||xt(t)&&this.trigger("tag:"+t.name,t))){var e=this.parseToken(t,this.tokens);this.trigger("template",e)}return this.stopRequested||this.trigger("end"),this},Ye.prototype.stop=function(){return this.stopRequested=!0,this},Ye);function Ye(t,e){this.handlers={},this.stopRequested=!1,this.tokens=t,this.parseToken=e}function Ze(t){this.token=t}var Ge=(Xe.prototype.render=function(e){var r,n,i,s,o,a,u,c,l;return D(this,function(t){switch(t.label){case 0:r={},t.label=1;case 1:t.trys.push([1,6,7,8]),n=F(Object.keys(this.hash)),i=n.next(),t.label=2;case 2:return i.done?[3,5]:(s=i.value,o=r,a=s,[4,ze(this.hash[s],e)]);case 3:o[a]=t.sent(),t.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return u=t.sent(),c={error:u},[3,8];case 7:try{i&&!i.done&&(l=n.return)&&l.call(n)}finally{if(c)throw c.error}return[7];case 8:return[2,r]}})},Xe);function Xe(t){var e,r;this.hash={};var n=new He(t,{});try{for(var i=F(n.readHashes()),s=i.next();!s.done;s=i.next()){var o=s.value;this.hash[o.name.content]=o.value}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}}var tr=(er.prototype.render=function(t,e){var r,n,i=[];try{for(var s=F(this.args),o=s.next();!o.done;o=s.next()){var a=o.value;g(a)?i.push([a[0],ze(a[1],e)]):i.push(ze(a,e))}}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return this.impl.apply({context:e,liquid:this.liquid},w([t],i))},er);function er(t,e,r,n){this.name=t,this.impl=e||x,this.args=r,this.liquid=n}var rr=(nr.prototype.value=function(e,r){var n,i,s,o,a,u;return D(this,function(t){switch(t.label){case 0:return r=r||e.opts.lenientIf&&0<this.filters.length&&"default"===this.filters[0].name,[4,this.initial.evaluate(e,r)];case 1:n=t.sent(),t.label=2;case 2:t.trys.push([2,7,8,9]),i=F(this.filters),s=i.next(),t.label=3;case 3:return s.done?[3,6]:[4,s.value.render(n,e)];case 4:n=t.sent(),t.label=5;case 5:return s=i.next(),[3,3];case 6:return[3,9];case 7:return o=t.sent(),a={error:o},[3,9];case 8:try{s&&!s.done&&(u=i.return)&&u.call(i)}finally{if(a)throw a.error}return[7];case 9:return[2,n]}})},nr);function nr(t,n){this.filters=[];var e=new He(t,n.options.operatorsTrie);this.initial=e.readExpression(),this.filters=e.readFilters().map(function(t){var e=t.name,r=t.args;return new tr(e,n.filters.get(e),r,n)})}function ir(e){var t={then:function(t){return t(e)},catch:function(){return t}};return t}function sr(r){var n={then:function(t,e){return e?e(r):n},catch:function(t){return t(r)}};return n}function or(n){return function(t){return t&&d(t.then)}(n)?n:function(t){return t&&d(t.next)&&d(t.throw)&&d(t.return)}(n)?function r(t){var e;try{e=n.next(t)}catch(t){return sr(t)}if(e.done)return ir(e.value);return or(e.value).then(r,function(t){var e;try{e=n.throw(t)}catch(t){return sr(t)}return e.done?ir(e.value):r(e.value)})}():ir(n)}function ar(t){return Promise.resolve(or(t))}function ur(t){var e;return or(t).then(function(t){return ir(e=t)}).catch(function(t){throw t}),e}var cr,lr=(t(hr,cr=Ze),hr.prototype.render=function(e,r){var n,i;return D(this,function(t){switch(t.label){case 0:return[4,new Ge(this.token.args).render(e)];case 1:return n=t.sent(),d((i=this.impl).render)?[4,i.render(e,r,n)]:[3,3];case 2:return[2,t.sent()];case 3:return[2]}})},hr);function hr(t,e,r){var n=cr.call(this,t)||this;n.name=t.name;var i=r.tags.get(t.name);return n.impl=Object.create(i),n.impl.liquid=r,n.impl.parse&&n.impl.parse(t,e),n}var pr,fr=(t(dr,pr=Ze),dr.prototype.render=function(e,r){var n;return D(this,function(t){switch(t.label){case 0:return[4,this.value.value(e,!1)];case 1:return n=t.sent(),r.write(n),[2]}})},dr);function dr(t,e){var r=pr.call(this,t)||this;return r.value=new rr(t.content,e),r}var vr,gr=(t(mr,vr=Ze),mr.prototype.render=function(t,e){return D(this,function(t){return e.write(this.str),[2]})},mr);function mr(t){var e=vr.call(this,t)||this;return e.str=t.getContent(),e}var yr=(wr.prototype.parse=function(t){for(var e,r=[];e=t.shift();)r.push(this.parseToken(e,t));return r},wr.prototype.parseToken=function(e,t){try{return xt(e)?new lr(e,t,this.liquid):kt(e)?new fr(e,this.liquid):new gr(e)}catch(t){throw new et(t,e)}},wr.prototype.parseStream=function(t){var r=this;return new $e(t,function(t,e){return r.parseToken(t,e)})},wr);function wr(t){this.liquid=t}var br={parse:function(t){var e=new He(t.args,this.liquid.options.operatorsTrie);this.key=e.readIdentifier().content,e.skipBlank(),de("="===e.peek(),function(){return"illegal token "+t.getText()}),e.advance(),this.value=e.remaining()},render:function(e){var r,n;return D(this,function(t){switch(t.label){case 0:return r=e.bottom(),n=this.key,[4,this.liquid._evalValue(this.value,e)];case 1:return r[n]=t.sent(),[2]}})}};function Tr(e){return g(e)?e:f(e)&&0<e.length?[e]:m(e)?Object.keys(e).map(function(t){return[t,e[t]]}):[]}function kr(t){return g(t)?t:[t]}var xr,Or=(t(qr,xr=r),qr.prototype.next=function(){this.i++},qr.prototype.index0=function(){return this.i},qr.prototype.index=function(){return this.i+1},qr.prototype.first=function(){return 0===this.i},qr.prototype.last=function(){return this.i===this.length-1},qr.prototype.rindex=function(){return this.length-this.i},qr.prototype.rindex0=function(){return this.length-this.i-1},qr.prototype.valueOf=function(){return JSON.stringify(this)},qr);function qr(t){var e=xr.call(this)||this;return e.i=0,e.length=t,e}var Sr={type:"block",parse:function(t,e){var r,n=this,i=new He(t.args,this.liquid.options.operatorsTrie),s=i.readIdentifier(),o=i.readIdentifier(),a=i.readValue();de(s.size()&&"in"===o.content&&a,function(){return"illegal tag: "+t.getText()}),this.variable=s.content,this.collection=a,this.hash=new Ge(i.remaining()),this.templates=[],this.elseTemplates=[];var u=this.liquid.parser.parseStream(e).on("start",function(){return r=n.templates}).on("tag:else",function(){return r=n.elseTemplates}).on("tag:endfor",function(){return u.stop()}).on("template",function(t){return r.push(t)}).on("end",function(){throw new Error("tag "+t.getText()+" not closed")});u.start()},render:function(e,r){var n,i,s,o,a,u,c,l,h,p,f,d,v;return D(this,function(t){switch(t.label){case 0:return n=this.liquid.renderer,s=Tr,[4,ze(this.collection,e)];case 1:return(i=s.apply(void 0,[t.sent()])).length?[3,3]:[4,n.renderTemplates(this.elseTemplates,e,r)];case 2:return t.sent(),[2];case 3:return[4,this.hash.render(e)];case 4:o=t.sent(),a=o.offset||0,u=void 0===o.limit?i.length:o.limit,i=i.slice(a,a+u),"reversed"in o&&i.reverse(),c={forloop:new Or(i.length)},e.push(c),t.label=5;case 5:t.trys.push([5,10,11,12]),l=F(i),h=l.next(),t.label=6;case 6:return h.done?[3,9]:(p=h.value,c[this.variable]=p,[4,n.renderTemplates(this.templates,e,r)]);case 7:if(t.sent(),r.break)return r.break=!1,[3,9];r.continue=!1,c.forloop.next(),t.label=8;case 8:return h=l.next(),[3,6];case 9:return[3,12];case 10:return f=t.sent(),d={error:f},[3,12];case 11:try{h&&!h.done&&(v=l.return)&&v.call(l)}finally{if(d)throw d.error}return[7];case 12:return e.pop(),[2]}})}},Er={parse:function(t,e){var r=this,n=new He(t.args,this.liquid.options.operatorsTrie);this.variable=function(t){var e=t.readIdentifier().content;if(e)return e;var r=t.readQuoted();if(r)return Be(r)}(n),de(this.variable,function(){return t.args+" not valid identifier"}),this.templates=[];var i=this.liquid.parser.parseStream(e);i.on("tag:endcapture",function(){return i.stop()}).on("template",function(t){return r.templates.push(t)}).on("end",function(){throw new Error("tag "+t.getText()+" not closed")}),i.start()},render:function(e){var r;return D(this,function(t){switch(t.label){case 0:return[4,this.liquid.renderer.renderTemplates(this.templates,e)];case 1:return r=t.sent(),e.bottom()[this.variable]=r,[2]}})}};var Rr,Lr,Dr={parse:function(t,e){var n=this;this.cond=new rr(t.args,this.liquid),this.cases=[],this.elseTemplates=[];var i=[],r=this.liquid.parser.parseStream(e).on("tag:when",function(t){i=[];for(var e=new He(t.args,n.liquid.options.operatorsTrie);!e.end();){var r=e.readValue();r&&n.cases.push({val:r,templates:i}),e.readTo(",")}}).on("tag:else",function(){return i=n.elseTemplates}).on("tag:endcase",function(){return r.stop()}).on("template",function(t){return i.push(t)}).on("end",function(){throw new Error("tag "+t.getText()+" not closed")});r.start()},render:function(e,r){var n,i,s,o,a,u,c,l,h;return D(this,function(t){switch(t.label){case 0:return n=this.liquid.renderer,s=v,[4,this.cond.value(e,e.opts.lenientIf)];case 1:i=s.apply(void 0,[t.sent()]),t.label=2;case 2:t.trys.push([2,7,8,9]),o=F(this.cases),a=o.next(),t.label=3;case 3:return a.done?[3,6]:(u=a.value,ze(u.val,e,e.opts.lenientIf)!==i?[3,5]:[4,n.renderTemplates(u.templates,e,r)]);case 4:return t.sent(),[2];case 5:return a=o.next(),[3,3];case 6:return[3,9];case 7:return c=t.sent(),l={error:c},[3,9];case 8:try{a&&!a.done&&(h=o.return)&&h.call(o)}finally{if(l)throw l.error}return[7];case 9:return[4,n.renderTemplates(this.elseTemplates,e,r)];case 10:return t.sent(),[2]}})}},Fr={parse:function(t,e){var r=this.liquid.parser.parseStream(e);r.on("token",function(t){"endcomment"===t.name&&r.stop()}).on("end",function(){throw new Error("tag "+t.getText()+" not closed")}),r.start()}};(Lr=Rr=Rr||{})[Lr.OUTPUT=0]="OUTPUT",Lr[Lr.STORE=1]="STORE";var Nr,Pr=Rr,Ir={parse:function(t){var e=t.args,r=new He(e,this.liquid.options.operatorsTrie);this.file=this.liquid.options.dynamicPartials?r.readValue():r.readFileName(),de(this.file,function(){return'illegal argument "'+t.args+'"'});var n=r.p;"with"===r.readIdentifier().content?(r.skipBlank(),":"!==r.peek()?this.withVar=r.readValue():r.p=n):r.p=n,this.hash=new Ge(r.remaining())},render:function(e,r){var n,i,s,o,a,u,c,l,h,p,f,d;return D(this,function(t){switch(t.label){case 0:return i=(n=this).liquid,s=n.hash,o=n.withVar,a=n.file,u=i.renderer,e.opts.dynamicPartials?Ot(a)?[4,u.renderTemplates(i.parse(Be(a)),e)]:[3,2]:[3,5];case 1:return h=t.sent(),[3,4];case 2:return[4,ze(a,e)];case 3:h=t.sent(),t.label=4;case 4:return l=h,[3,6];case 5:l=a.getText(),t.label=6;case 6:return de(c=l,function(){return'illegal filename "'+a.getText()+'":"'+c+'"'}),p=e.saveRegister("blocks","blockMode"),e.setRegister("blocks",{}),e.setRegister("blockMode",Pr.OUTPUT),[4,s.render(e)];case 7:return f=t.sent(),o&&(f[c]=ze(o,e)),[4,i._parseFile(c,e.opts,e.sync)];case 8:return d=t.sent(),e.push(f),[4,u.renderTemplates(d,e,r)];case 9:return t.sent(),e.pop(),e.restoreRegister(p),[2]}})}},Mr={parse:function(t){var e=t.args,r=new He(e,this.liquid.options.operatorsTrie);for(this.file=this.liquid.options.dynamicPartials?r.readValue():r.readFileName(),de(this.file,function(){return'illegal argument "'+t.args+'"'});!r.end();){r.skipBlank();var n=r.p,i=r.readIdentifier();if(("with"===i.content||"for"===i.content)&&(r.skipBlank(),":"!==r.peek())){var s=r.readValue();if(s){var o=r.p,a=void 0;"as"===r.readIdentifier().content?a=r.readIdentifier():r.p=o,this[i.content]={value:s,alias:a&&a.content},r.skipBlank(),","===r.peek()&&r.advance();continue}}r.p=n;break}this.hash=new Ge(r.remaining())},render:function(e,r){var n,i,s,o,a,u,c,l,h,p,f,d,v,g,m,y,w,b,T,k,x,O,q,S,E;return D(this,function(t){switch(t.label){case 0:return i=(n=this).liquid,s=n.file,o=n.hash,a=i.renderer,e.opts.dynamicPartials?Ot(s)?[4,a.renderTemplates(i.parse(Be(s)),e)]:[3,2]:[3,4];case 1:return l=t.sent(),[3,3];case 2:l=ze(s,e),t.label=3;case 3:return c=l,[3,5];case 4:c=s.getText(),t.label=5;case 5:de(u=c,function(){return'illegal filename "'+s.getText()+'":"'+u+'"'}),h={};try{p=e.environments.themeConfig||{sections:[]},p.sections,f=L(p,["sections"]),h=R({},e.environments,{settings:f})}catch(t){console.error("ctx.environments.themeConfig 解构失败",t)}return d=new gt(h,e.opts,e.sync),[4,o.render(e)];case 6:if(v=t.sent(),this.with&&(g=this.with,y=g.value,w=g.alias,v[w||u]=ze(y,e)),d.push(v),!this.for)return[3,16];m=this.for,y=m.value,w=m.alias,b=Tr(b=ze(y,e)),v.forloop=new Or(b.length),t.label=7;case 7:t.trys.push([7,13,14,15]),T=F(b),k=T.next(),t.label=8;case 8:return k.done?[3,12]:(x=k.value,v[w]=x,[4,i._parseFile(u,d.opts,d.sync)]);case 9:return q=t.sent(),[4,a.renderTemplates(q,d,r)];case 10:t.sent(),v.forloop.next(),t.label=11;case 11:return k=T.next(),[3,8];case 12:return[3,15];case 13:return O=t.sent(),S={error:O},[3,15];case 14:try{k&&!k.done&&(E=T.return)&&E.call(T)}finally{if(S)throw S.error}return[7];case 15:return[3,19];case 16:return[4,i._parseFile(u,d.opts,d.sync)];case 17:return q=t.sent(),[4,a.renderTemplates(q,d,r)];case 18:t.sent(),t.label=19;case 19:return[2]}})}},jr={parse:function(t){var e=new He(t.args,this.liquid.options.operatorsTrie);this.variable=e.readIdentifier().content},render:function(t,e){var r=t.environments;u(r[this.variable])||(r[this.variable]=0),e.write(a(--r[this.variable]))}},Ar={parse:function(t){var e=new He(t.args,this.liquid.options.operatorsTrie),r=e.readValue();for(e.skipBlank(),this.candidates=[],r&&(":"===e.peek()?(this.group=r,e.advance()):this.candidates.push(r));!e.end();){var n=e.readValue();n&&this.candidates.push(n),e.readTo(",")}de(this.candidates.length,function(){return"empty candidates: "+t.getText()})},render:function(t,e){var r="cycle:"+ze(this.group,t)+":"+this.candidates.join(","),n=t.getRegister("cycle"),i=n[r];void 0===i&&(i=n[r]=0);var s=this.candidates[i];i=(i+1)%this.candidates.length,n[r]=i;var o=ze(s,t);e.write(o)}},Cr={parse:function(t,e){var r,n=this;this.branches=[],this.elseTemplates=[];var i=this.liquid.parser.parseStream(e).on("start",function(){return n.branches.push({cond:new rr(t.args,n.liquid),templates:r=[]})}).on("tag:elsif",function(t){n.branches.push({cond:new rr(t.args,n.liquid),templates:r=[]})}).on("tag:else",function(){return r=n.elseTemplates}).on("tag:else-",function(){return r=n.elseTemplates}).on("tag:endif",function(){return i.stop()}).on("tag:endif-",function(){return i.stop()}).on("template",function(t){return r.push(t)}).on("end",function(){throw new Error("tag "+t.getText()+" not closed")});i.start()},render:function(e,r){var n,i,s,o,a,u,c;return D(this,function(t){switch(t.label){case 0:n=this.liquid.renderer,t.label=1;case 1:t.trys.push([1,7,8,9]),i=F(this.branches),s=i.next(),t.label=2;case 2:return s.done?[3,6]:[4,(o=s.value).cond.value(e,e.opts.lenientIf)];case 3:return A(t.sent(),e)?[4,n.renderTemplates(o.templates,e,r)]:[3,5];case 4:return t.sent(),[2];case 5:return s=i.next(),[3,2];case 6:return[3,9];case 7:return a=t.sent(),u={error:a},[3,9];case 8:try{s&&!s.done&&(c=i.return)&&c.call(i)}finally{if(u)throw u.error}return[7];case 9:return[4,n.renderTemplates(this.elseTemplates,e,r)];case 10:return t.sent(),[2]}})}},Vr={parse:function(t){var e=new He(t.args,this.liquid.options.operatorsTrie);this.variable=e.readIdentifier().content},render:function(t,e){var r=t.environments;u(r[this.variable])||(r[this.variable]=0);var n=r[this.variable];r[this.variable]++,e.write(a(n))}},_r={parse:function(t,e){var r=new He(t.args,this.liquid.options.operatorsTrie),n=this.liquid.options.dynamicPartials?r.readValue():r.readFileName();de(n,function(){return'illegal argument "'+t.args+'"'}),this.file=n,this.hash=new Ge(r.remaining()),this.tpls=this.liquid.parser.parse(e)},render:function(e,r){var n,i,s,o,a,u,c,l,h,p,f,d,v,g,m;return D(this,function(t){switch(t.label){case 0:return i=(n=this).liquid,s=n.hash,o=n.file,a=i.renderer,"none"!==o.getText()?[3,2]:(e.setRegister("blockMode",Pr.OUTPUT),[4,a.renderTemplates(this.tpls,e)]);case 1:return u=t.sent(),r.write(u),[2];case 2:return e.opts.dynamicPartials?Ot(o)?[4,a.renderTemplates(i.parse(Be(o)),e)]:[3,4]:[3,6];case 3:return h=t.sent(),[3,5];case 4:h=ze(this.file,e),t.label=5;case 5:return l=h,[3,7];case 6:l=o.getText(),t.label=7;case 7:return de(c=l,function(){return'file "'+o.getText()+'"("'+c+'") not available'}),[4,i._parseFile(c,e.opts,e.sync)];case 8:return p=t.sent(),e.setRegister("blockMode",Pr.STORE),[4,a.renderTemplates(this.tpls,e)];case 9:return f=t.sent(),void 0===(d=e.getRegister("blocks"))[""]&&(d[""]=function(){return f}),e.setRegister("blockMode",Pr.OUTPUT),g=(v=e).push,[4,s.render(e)];case 10:return g.apply(v,[t.sent()]),[4,a.renderTemplates(p,e)];case 11:return m=t.sent(),e.pop(),r.write(m),[2]}})}},zr=(t(Br,Nr=r),Br.prototype.super=function(){return this.superBlockRender()},Br);function Br(t){void 0===t&&(t=function(){return""});var e=Nr.call(this)||this;return e.superBlockRender=t,e}var Hr,Ur={parse:function(t,e){var r=this,n=/\w+/.exec(t.args);this.block=n?n[0]:"",this.tpls=[];var i=this.liquid.parser.parseStream(e).on("tag:endblock",function(){return i.stop()}).on("template",function(t){return r.tpls.push(t)}).on("end",function(){throw new Error("tag "+t.getText()+" not closed")});i.start()},render:function(e,r){var n;return D(this,function(t){switch(t.label){case 0:return n=this.getBlockRender(e),[4,this.emitHTML(e,r,n)];case 1:return t.sent(),[2]}})},getBlockRender:function(n){function e(e){var r;return D(this,function(t){switch(t.label){case 0:return n.push({block:e}),[4,i.renderer.renderTemplates(s,n)];case 1:return r=t.sent(),n.pop(),[2,r]}})}var i=this.liquid,s=this.tpls,r=n.getRegister("blocks")[this.block];return r?function(t){return r(new zr(function(){return e(t)}))}:e},emitHTML:function(e,r,n){var i,s;return D(this,function(t){switch(t.label){case 0:return e.getRegister("blockMode",Pr.OUTPUT)!==Pr.STORE?[3,1]:(e.getRegister("blocks")[this.block]=n,[3,3]);case 1:return s=(i=r).write,[4,n(new zr)];case 2:s.apply(i,[t.sent()]),t.label=3;case 3:return[2]}})}},Kr={parse:function(t,e){var r=this;this.tokens=[];var n=this.liquid.parser.parseStream(e);n.on("token",function(t){"endraw"===t.name?n.stop():r.tokens.push(t)}).on("end",function(){throw new Error("tag "+t.getText()+" not closed")}),n.start()},render:function(){return this.tokens.map(function(t){return t.getText()}).join("")}},Qr=(t(Wr,Hr=Or),Wr.prototype.row=function(){return Math.floor(this.i/this.cols)+1},Wr.prototype.col0=function(){return this.i%this.cols},Wr.prototype.col=function(){return this.col0()+1},Wr.prototype.col_first=function(){return 0===this.col0()},Wr.prototype.col_last=function(){return this.col()===this.cols},Wr);function Wr(t,e){var r=Hr.call(this,t)||this;return r.length=t,r.cols=e,r}var Jr={product:{action:"/cart/add"}};function $r(t){var e=function(t){var e=t.split(",").map(function(t){return t.replace(/\s/g,"")}),r={enctype:"multipart/form-data",method:"post","accept-charset":"UTF-8",type:""};if(!e.length)return r;var n=e[0].replace(/['"]/g,""),i=-1===n.indexOf(":")&&!!n,s=r;return i&&(s.type=n,e.shift()),s=R({},s,Jr[n]),e.forEach(function(t){var e=t.split(":");e[1]&&(s[e[0]]=function(t){var e=t;return/['"]/g.test(t)||(e="{{ "+t+" }}"),e}(e[1]))}),s}(t);return"<form "+function(r){var n="";return Object.keys(r).forEach(function(t){var e=('"'+r[t]+'"').replace(/"'|'"/g,'"');n+=" "+t+"="+e}),n}(e)+'>\n    <input type="hidden" value="'+(e.type||"")+'" name="form_type">\n    <input type="hidden" name="utf8" value="✓">\n  '}var Yr={header:'<div id="shopify-section-header" class="shopify-section" data-shopify-editor-section="{"id":"announcement-bar","type":"announcement-bar","disabled":false}">'},Zr={assign:br,for:Sr,capture:Er,case:Dr,comment:Fr,include:Ir,render:Mr,decrement:jr,increment:Vr,cycle:Ar,if:Cr,layout:_r,block:Ur,raw:Kr,tablerow:{parse:function(t,e){var r=this,n=new He(t.args,this.liquid.options.operatorsTrie);this.variable=n.readIdentifier(),n.skipBlank();var i,s=n.readIdentifier();de(s&&"in"===s.content,function(){return"illegal tag: "+t.getText()}),this.collection=n.readValue(),this.hash=new Ge(n.remaining()),this.templates=[];var o=this.liquid.parser.parseStream(e).on("start",function(){return i=r.templates}).on("tag:endtablerow",function(){return o.stop()}).on("template",function(t){return i.push(t)}).on("end",function(){throw new Error("tag "+t.getText()+" not closed")});o.start()},render:function(e,r){var n,i,s,o,a,u,c,l,h,p;return D(this,function(t){switch(t.label){case 0:return i=Tr,[4,ze(this.collection,e)];case 1:return n=i.apply(void 0,[t.sent()]),[4,this.hash.render(e)];case 2:s=t.sent(),o=s.offset||0,a=void 0===s.limit?n.length:s.limit,n=n.slice(o,o+a),u=s.cols||n.length,c=this.liquid.renderer,l=new Qr(n.length,u),h={tablerowloop:l},e.push(h),p=0,t.label=3;case 3:return p<n.length?(h[this.variable.content]=n[p],0===l.col0()&&(1!==l.row()&&r.write("</tr>"),r.write('<tr class="row'+l.row()+'">')),r.write('<td class="col'+l.col()+'">'),[4,c.renderTemplates(this.templates,e,r)]):[3,6];case 4:t.sent(),r.write("</td>"),t.label=5;case 5:return p++,l.next(),[3,3];case 6:return n.length&&r.write("</tr>"),e.pop(),[2]}})}},unless:{parse:function(t,e){var r,n=this;this.templates=[],this.branches=[],this.elseTemplates=[];var i=this.liquid.parser.parseStream(e).on("start",function(){r=n.templates,n.cond=new rr(t.args,n.liquid)}).on("tag:elsif",function(t){n.branches.push({cond:new rr(t.args,n.liquid),templates:r=[]})}).on("tag:else",function(){return r=n.elseTemplates}).on("tag:endunless",function(){return i.stop()}).on("template",function(t){return r.push(t)}).on("end",function(){throw new Error("tag "+t.getText()+" not closed")});i.start()},render:function(e,r){var n,i,s,o,a,u,c;return D(this,function(t){switch(t.label){case 0:return n=this.liquid.renderer,[4,this.cond.value(e,e.opts.lenientIf)];case 1:return C(t.sent(),e)?[4,n.renderTemplates(this.templates,e,r)]:[3,3];case 2:return t.sent(),[2];case 3:t.trys.push([3,9,10,11]),i=F(this.branches),s=i.next(),t.label=4;case 4:return s.done?[3,8]:[4,(o=s.value).cond.value(e,e.opts.lenientIf)];case 5:return A(t.sent(),e)?[4,n.renderTemplates(o.templates,e,r)]:[3,7];case 6:return t.sent(),[2];case 7:return s=i.next(),[3,4];case 8:return[3,11];case 9:return a=t.sent(),u={error:a},[3,11];case 10:try{s&&!s.done&&(c=i.return)&&c.call(i)}finally{if(u)throw u.error}return[7];case 11:return[4,n.renderTemplates(this.elseTemplates,e,r)];case 12:return t.sent(),[2]}})}},break:{render:function(t,e){e.break=!0}},continue:{render:function(t,e){e.continue=!0}},echo:{parse:function(t){var e=" {{ "+t.args+" }} ";this.tokenizer=new He(e,this.liquid.options.operatorsTrie)},render:function(e,r){var n,i,s,o,a,u,c,l,h,p,f,d,v;return D(this,function(t){switch(t.label){case 0:i=(n=this).liquid,s=n.tokenizer,o=s.readTopLevelTokens(i.options),a=i.parser.parse(o),t.label=1;case 1:t.trys.push([1,8,9,10]),u=F(a),c=u.next(),t.label=2;case 2:if(c.done)return[3,7];l=c.value,t.label=3;case 3:return t.trys.push([3,5,,6]),[4,l.render(e,r)];case 4:return(h=t.sent())&&r.write(h),[3,6];case 5:return p=t.sent(),console.error("liquid tag parseError",p),[3,6];case 6:return c=u.next(),[3,2];case 7:return[3,10];case 8:return f=t.sent(),d={error:f},[3,10];case 9:try{c&&!c.done&&(v=u.return)&&v.call(u)}finally{if(d)throw d.error}return[7];case 10:return[2]}})}},form:{parse:function(t,e){var r=this,n=new He(t.args,this.liquid.options.operatorsTrie);this.variable=function(t){var e=t.readIdentifier().content;if(e)return e;var r=t.readQuoted();if(r)return Be(r)}(n),this.templates=[];var i=this.liquid.parser.parseStream(e);this.args=$r(t.args),i.on("tag:endform",function(){return i.stop()}).on("template",function(t){r.templates.push(t)}).on("end",function(){throw new Error("tag "+t.getText()+" not closed")}),i.start()},render:function(e,t){var r;return D(this,function(t){switch(t.label){case 0:return[4,this.liquid.renderer.renderTemplates(this.templates,e)];case 1:return r=t.sent(),[2,""+this.args+r+"</form>"]}})}},javascript:{parse:function(t,e){var r=this,n=new He(t.args,this.liquid.options.operatorsTrie);this.variable=function(t){var e=t.readIdentifier().content;if(e)return e;var r=t.readQuoted();if(r)return Be(r)}(n),this.templates=[];var i=this.liquid.parser.parseStream(e);i.on("tag:endjavascript",function(){return i.stop()}).on("template",function(t){r.templates.push(t)}).on("end",function(){throw new Error("tag "+t.getText()+" not closed")}),i.start()},render:function(e,t){var r;return D(this,function(t){switch(t.label){case 0:return[4,this.liquid.renderer.renderTemplates(this.templates,e)];case 1:return r=t.sent(),[2,"<script>\n        window.addEventListener('load',function(){"+r+"})\n    <\/script>"]}})}},style:{parse:function(t,e){var r=this,n=new He(t.args,this.liquid.options.operatorsTrie);this.variable=function(t){var e=t.readIdentifier().content;if(e)return e;var r=t.readQuoted();if(r)return Be(r)}(n),this.templates=[];var i=this.liquid.parser.parseStream(e);i.on("tag:endstyle",function(){return i.stop()}).on("template",function(t){r.templates.push(t)}).on("end",function(){throw new Error("tag "+t.getText()+" not closed")}),i.start()},render:function(e,t){var r;return D(this,function(t){switch(t.label){case 0:return[4,this.liquid.renderer.renderTemplates(this.templates,e)];case 1:return r=t.sent(),[2,"<style>\n    "+r+"\n    </style>"]}})}},section:{parse:function(t){var e=new He(t.args,this.liquid.options.operatorsTrie);this.file=e.readValue();var r=new P;this.domainFiles=r.rootData;var n=r.getTpl("config/settings_data.json");this.themeConfig=function(t){if(!t)return{};var n=JSON.parse(t);return Object.keys(n.current.sections).forEach(function(t){var e=n.current.sections[t],r=[];e.blocks&&Object.keys(e.blocks).forEach(function(t){r.push(e.blocks[t])}),e.blocks=r}),n}(n).current,this.hash=new Ge(e.remaining())},render:function(e){var r,n,i,s,o,a,u,c,l,h,p,f,d,v;return D(this,function(t){switch(t.label){case 0:return n=(r=this).liquid,i=r.file,s=r.hash,o=n.renderer,a=this.themeConfig,u=a.sections,c=L(a,["sections"]),Ot(this.file)?[4,o.renderTemplates(n.parse(Be(i)),e)]:[3,2];case 1:return h=t.sent(),[3,3];case 2:h=ze(i,e),t.label=3;case 3:return(l=h).indexOf("sections/")<0&&(l="sections/"+l),p={},p=Array.isArray(u)?u&&u.find(function(t){return t.type===l}):u[l],[4,s.render(e)];case 4:return f=t.sent(),d=R({},e.environments,{section:p,settings:c},f,e.globals),[4,this.liquid.renderFile(l,d)];case 5:return v=t.sent(),Yr[l]&&(v=Yr[l]+" "+v+" </div>"),[2,v]}})}},liquid:{parse:function(t){var e=function(t){return t.split(/\n/).map(function(t){return/[\S]/g.test(t)?"{% "+t.replace(/(^\s*)|(\s*$)/g,"")+" %}":""}).filter(function(t){return!!t}).join(" \n")}(t.args),r=new He(e,this.liquid.options.operatorsTrie),n=r.readTopLevelTokens(this.liquid.options);this.templates=this.liquid.parser.parse(n),this.key=r.readIdentifier().content},render:function(e,r){var n,i;return D(this,function(t){switch(t.label){case 0:return n=e.bottom(),i=this.key,[4,this.liquid.renderer.renderTemplates(this.templates,e,r)];case 1:return n[i]=t.sent(),[2]}})}},schema:{parse:function(t,e){var r=this;this.tokens=[];var n=this.liquid.parser.parseStream(e);n.on("token",function(t){"endschema"===t.name?n.stop():r.tokens.push(t)}).on("end",function(){throw new Error("tag "+t.raw+" not closed")}),n.start()},render:function(t,e){return D(this,function(t){return[2,""]})}},paginate:{parse:function(t,e){var r=this;this.tokens=[];var n=this.liquid.parser.parseStream(e);n.on("token",function(t){"endpaginate"===t.name?n.stop():r.tokens.push(t)}).on("end",function(){throw new Error("tag "+t.raw+" not closed")}),n.start()},render:function(t,e){return D(this,function(t){return[2,""]})}}},Gr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},Xr={"&amp;":"&","&lt;":"<","&gt;":">","&#34;":'"',"&#39;":"'"};function tn(t){return a(t).replace(/&|<|>|"|'/g,function(t){return Gr[t]})}var en=Math.abs,rn=Math.max,nn=Math.min,sn=Math.ceil,on=Math.floor;var an=/%([-_0^#:]+)?(\d+)?([EO])?(.)/,un=["January","February","March","April","May","June","July","August","September","October","November","December"],cn=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ln=un.map(fn),hn=cn.map(fn),pn={1:"st",2:"nd",3:"rd",default:"th"};function fn(t){return t.slice(0,3)}function dn(t){for(var e=0,r=0;r<t.getMonth();++r)e+=[31,function(t){var e=t.getFullYear();return!(0!=(3&e)||!(e%100||e%400==0&&e))}(t)?29:28,31,30,31,30,31,31,30,31,30,31][r];return e+t.getDate()}function vn(t,e){var r=dn(t)+(e-t.getDay()),n=7-new Date(t.getFullYear(),0,1).getDay()+e;return String(Math.floor((r-n)/7)+1)}var gn={d:2,e:2,H:2,I:2,j:3,k:2,l:2,L:3,m:2,M:2,S:2,U:2,W:2},mn={a:" ",A:" ",b:" ",B:" ",c:" ",e:" ",k:" ",l:" ",p:" ",P:" "},yn={a:function(t){return hn[t.getDay()]},A:function(t){return cn[t.getDay()]},b:function(t){return ln[t.getMonth()]},B:function(t){return un[t.getMonth()]},c:function(t){return t.toLocaleString()},C:function(t){return function(t){return parseInt(t.getFullYear().toString().substring(0,2),10)}(t)},d:function(t){return t.getDate()},e:function(t){return t.getDate()},H:function(t){return t.getHours()},I:function(t){return String(t.getHours()%12||12)},j:function(t){return dn(t)},k:function(t){return t.getHours()},l:function(t){return String(t.getHours()%12||12)},L:function(t){return t.getMilliseconds()},m:function(t){return t.getMonth()+1},M:function(t){return t.getMinutes()},N:function(t,e){var r=Number(e.width)||9;return function(t,e,r){return void 0===r&&(r=" "),k(t,e,r,function(t,e){return t+e})}(String(t.getMilliseconds()).substr(0,r),r,"0")},p:function(t){return t.getHours()<12?"AM":"PM"},P:function(t){return t.getHours()<12?"am":"pm"},q:function(t){return function(t){var e=t.getDate().toString(),r=parseInt(e.slice(-1));return pn[r]||pn.default}(t)},s:function(t){return Math.round(t.valueOf()/1e3)},S:function(t){return t.getSeconds()},u:function(t){return t.getDay()||7},U:function(t){return vn(t,0)},w:function(t){return t.getDay()},W:function(t){return vn(t,1)},x:function(t){return t.toLocaleDateString()},X:function(t){return t.toLocaleTimeString()},y:function(t){return t.getFullYear().toString().substring(2,4)},Y:function(t){return t.getFullYear()},z:function(t,e){var r=t.getTimezoneOffset(),n=Math.abs(r),i=n%60;return(0<r?"-":"+")+T(Math.floor(n/60),2,"0")+(e.flags[":"]?":":"")+T(i,2,"0")},t:function(){return"\t"},n:function(){return"\n"},"%":function(){return"%"}};function wn(t,e){var r,n,i=y(e,5),s=i[0],o=i[1],a=void 0===o?"":o,u=i[2],c=i[3],l=i[4],h=yn[l];if(!h)return s;var p={};try{for(var f=F(a),d=f.next();!d.done;d=f.next()){p[d.value]=!0}}catch(t){r={error:t}}finally{try{d&&!d.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}var v=String(h(t,{flags:p,width:u,modifier:c})),g=mn[l]||"0",m=u||gn[l]||0;return p["^"]?v=v.toUpperCase():p["#"]&&(v=function(t){return w(t).some(function(t){return"a"<=t&&t<="z"})?t.toUpperCase():t.toLowerCase()}(v)),p._?g=" ":p[0]&&(g="0"),p["-"]&&(m=0),T(v,m,g)}yn.h=yn.b;var bn,Tn=(t(kn,bn=Date),kn.prototype.getDisplayDate=function(){return new Date(+this+60*this.inputTimezoneOffset*1e3)},kn);function kn(t){var e=bn.call(this,t)||this;e.dateString=t,e.ISO8601_TIMEZONE_PATTERN=/([zZ]|([+-])(\d{2}):(\d{2}))$/,e.inputTimezoneOffset=0;var r=t.match(e.ISO8601_TIMEZONE_PATTERN);if(r&&"Z"===r[1])e.inputTimezoneOffset=e.getTimezoneOffset();else if(r&&r[2]&&r[3]&&r[4]){var n=y(r,5),i=n[2],s=n[3],o=n[4],a=("+"===i?1:-1)*(60*parseInt(s,10)+parseInt(o,10));e.inputTimezoneOffset=e.getTimezoneOffset()+a}return e}var xn=/^'[^']*'|"[^"]*"$/;var On=Object.freeze({t:function(t,e){if(xn.test(t))return t;var r,n=(new P).rootData.filter(function(t){return"locales"===t.name})[0].data;try{r=n.filter(function(t){return"zh-CN.json"===t.name})[0].data}catch(t){console.log("该模板C端没有适配该语言: zh-CN, 使用默认语言包 en.default.json"),r=n.filter(function(t){return"en.default.json"===t.name})[0].data}return function(t,e,r){for(var n,i=e,s=t.split("."),o=0;o<s.length;o++){var a=s[o];i&&(m(n=i)&&!g(n)&&!d(n))&&(i=i[a])}if(g(r)&&2===r.length&&f(i)){var u=y(r,2),c=u[0],l=u[1],h=new RegExp("{{\\s?"+c+"\\s?}}","g");i=i.replace(h,l)}return i}(t,JSON.parse(r.value),e)},escape:tn,escapeOnce:function(t){return tn(function(t){return String(t).replace(/&(amp|lt|gt|#34|#39);/g,function(t){return Xr[t]})}(t))},newlineToBr:function(t){return t.replace(/\n/g,"<br />\n")},stripHtml:function(t){return t.replace(/<script.*?<\/script>|<!--.*?-->|<style.*?<\/style>|<.*?>/g,"")},urlDecode:function(t){return t.split("+").map(decodeURIComponent).join(" ")},urlEncode:function(t){return t.split(" ").map(encodeURIComponent).join("+")},urlEscape:function(t){return encodeURIComponent(t)},join:function(t,e){return t.join(void 0===e?" ":e)},last:function(t){return g(t)?h(t):""},first:function(t){return g(t)?t[0]:""},reverse:function(t){return w(t).reverse()},sort:function(t,e){function r(t){return e?n.context.getFromScope(t,e.split(".")):t}var n=this;return kr(t).sort(function(t,e){return(t=r(t))<(e=r(e))?-1:e<t?1:0})},size:function(t){return t&&t.length||0},map:function(t,e){var r=this;return kr(t).map(function(t){return r.context.getFromScope(t,e.split("."))})},compact:function(t){return kr(t).filter(function(t){return!c(t)})},concat:function(t,e){return kr(t).concat(e)},slice:function(t,e,r){return void 0===r&&(r=1),e=e<0?t.length+e:e,t.slice(e,e+r)},where:function(t,r,n){var i=this;return kr(t).filter(function(t){var e=i.context.getFromScope(t,String(r).split("."));return void 0===n?A(e,i.context):e===n})},uniq:function(t){var e={};return(t||[]).filter(function(t){return!e.hasOwnProperty(String(t))&&(e[String(t)]=!0)})},date:function(t,e){var r=t;return"now"===t||"today"===t?r=new Date:u(t)?r=new Date(1e3*t):f(t)&&(r=/^\d+$/.test(t)?new Date(1e3*+t):this.context.opts.preserveTimezones?new Tn(t):new Date(t)),function(t){return t instanceof Date&&!isNaN(t.getTime())}(r)?function(t,e){var r=t;r instanceof Tn&&(r=r.getDisplayDate());for(var n,i="",s=e;n=an.exec(s);)i+=s.slice(0,n.index),s=s.slice(n.index+n[0].length),i+=wn(r,n);return i+s}(r,e):t},Default:function(t,e){return g(t)||f(t)?t.length?t:e:C(v(t),this.context)?e:t},json:function(t){return JSON.stringify(t)},append:function(t,e){return de(2===arguments.length,function(){return"append expect 2 arguments"}),a(t)+a(e)},prepend:function(t,e){return de(2===arguments.length,function(){return"prepend expect 2 arguments"}),a(e)+a(t)},lstrip:function(t){return a(t).replace(/^\s+/,"")},downcase:function(t){return a(t).toLowerCase()},upcase:function(t){return a(t).toUpperCase()},remove:function(t,e){return a(t).split(String(e)).join("")},removeFirst:function(t,e){return a(t).replace(String(e),"")},rstrip:function(t){return a(t).replace(/\s+$/,"")},split:function(t,e){return a(t).split(String(e))},strip:function(t){return a(t).trim()},stripNewlines:function(t){return a(t).replace(/\n/g,"")},capitalize:function(t){return(t=a(t)).charAt(0).toUpperCase()+t.slice(1).toLowerCase()},replace:function(t,e,r){return a(t).split(String(e)).join(r)},replaceFirst:function(t,e,r){return a(t).replace(String(e),r)},truncate:function(t,e,r){return void 0===e&&(e=50),void 0===r&&(r="..."),(t=a(t)).length<=e?t:t.substr(0,e-r.length)+r},truncatewords:function(t,e,r){void 0===e&&(e=15),void 0===r&&(r="...");var n=t.split(/\s+/),i=n.slice(0,e).join(" ");return n.length>=e&&(i+=r),i},abs:en,atLeast:rn,atMost:nn,ceil:sn,dividedBy:function(t,e){return t/e},floor:on,minus:function(t,e){return t-e},modulo:function(t,e){return t%e},times:function(t,e){return t*e},round:function(t,e){void 0===e&&(e=0);var r=Math.pow(10,e);return Math.round(t*r)/r},plus:function(t,e){return Number(t)+Number(e)},sortNatural:function(t,r){return t&&t.sort?void 0!==r?w(t).sort(function(t,e){return q(t[r],e[r])}):w(t).sort(q):[]},imageUrl:function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return t.forEach(function(t){var e=-1<r.indexOf("?");r+=(e?"&":"?")+t[0]+"="+t[1]}),r},stylesheetTag:function(t){return'<link href="'+t+'" rel="stylesheet" type="text/css" media="all">'},assetUrl:function(t){return function(t,n){var i="";return function t(e){if(e)for(var r=0;r<e.length;r++){if("file"===e[r].type&&e[r].name===n){i=e[r].data.public_url;break}"folder"===e[r].type&&t(e[r].data)}}(t),i}((new P).rootData,t)},defaultErrors:function(t){return"Please enter a valid "+t.error_strings},color:function(t){return function(t){try{return"rgba("+t.r+","+t.g+","+t.b+","+t.a+")"}catch(t){return""}}(t)},moneyWithCurrency:function(t){return"$ "+String(t)+" USD"},money:function(t){return"$ "+String(t)}}),qn=(Sn.prototype.get=function(t){var e=this.impls[t];return de(e,function(){return'tag "'+t+'" not found'}),e},Sn.prototype.set=function(t,e){this.impls[t]=e},Sn);function Sn(){this.impls={}}var En=(Rn.prototype.get=function(t){var e=this.impls[t];return de(e||!this.strictFilters,function(){return"undefined filter: "+t}),e},Rn.prototype.set=function(t,e){this.impls[t]=e},Rn.prototype.create=function(t,e){return new tr(t,this.get(t),e,this.liquid)},Rn);function Rn(t,e){this.strictFilters=t,this.liquid=e,this.impls={}}var Ln=(Dn.prototype.parse=function(t,e){var r=new He(t,this.options.operatorsTrie,e).readTopLevelTokens(this.options);return this.parser.parse(r)},Dn.prototype._render=function(t,e,r,n){var i=R({},this.options,Q(r)),s=new gt(e,i,n),o=new Ke(i.keepOutputType);return this.renderer.renderTemplates(t,s,o)},Dn.prototype.render=function(e,r,n){return s(this,void 0,void 0,function(){return D(this,function(t){return[2,ar(this._render(e,r,n,!1))]})})},Dn.prototype.renderSync=function(t,e,r){return ur(this._render(t,e,r,!0))},Dn.prototype._parseAndRender=function(t,e,r,n){var i=this.parse(t);return this._render(i,e,r,n)},Dn.prototype.parseAndRender=function(e,r,n){return s(this,void 0,void 0,function(){return D(this,function(t){return[2,ar(this._parseAndRender(e,r,n,!1))]})})},Dn.prototype.parseAndRenderSync=function(t,e,r){return ur(this._parseAndRender(t,e,r,!0))},Dn.prototype._parseFile=function(e,r,n){var i,s,o,a,u,c,l,h,p,f,d,v,g,m;return D(this,function(t){switch(t.label){case 0:i=R({},this.options,Q(r)),s=i.root.map(function(t){return i.fs.resolve(t,e,i.extname)}),void 0!==i.fs.fallback&&void 0!==(u=i.fs.fallback(e))&&s.push(u),t.label=1;case 1:t.trys.push([1,13,14,15]),o=F(s),a=o.next(),t.label=2;case 2:return a.done?[3,12]:(u=a.value,(c=i.cache)?[4,c.read(u)]:[3,4]);case 3:if(l=t.sent())return[2,l];t.label=4;case 4:return n?(h=i.fs.existsSync(u),[3,7]):[3,5];case 5:return[4,i.fs.exists(u)];case 6:h=t.sent(),t.label=7;case 7:return h?(f=this.parse,n?(d=i.fs.readFileSync(u),[3,10]):[3,8]):[3,11];case 8:return[4,i.fs.readFile(u)];case 9:d=t.sent(),t.label=10;case 10:return p=f.apply(this,[d,u]),c&&c.write(u,p),[2,p];case 11:return a=o.next(),[3,2];case 12:return[3,15];case 13:return v=t.sent(),g={error:v},[3,15];case 14:try{a&&!a.done&&(m=o.return)&&m.call(o)}finally{if(g)throw g.error}return[7];case 15:throw this.lookupError(e,i.root)}})},Dn.prototype.parseFile=function(e,r){return s(this,void 0,void 0,function(){return D(this,function(t){return[2,ar(this._parseFile(e,r,!1))]})})},Dn.prototype.parseFileSync=function(t,e){return ur(this._parseFile(t,e,!0))},Dn.prototype.renderFile=function(r,n,i){return s(this,void 0,void 0,function(){var e;return D(this,function(t){switch(t.label){case 0:return[4,this.parseFile(r,i)];case 1:return e=t.sent(),[2,this.render(e,n,i)]}})})},Dn.prototype.renderFileSync=function(t,e,r){var n=this.parseFileSync(t,r);return this.renderSync(n,e,r)},Dn.prototype._evalValue=function(t,e){return new rr(t,this).value(e,!1)},Dn.prototype.evalValue=function(e,r){return s(this,void 0,void 0,function(){return D(this,function(t){return[2,ar(this._evalValue(e,r))]})})},Dn.prototype.evalValueSync=function(t,e){return ur(this._evalValue(t,e))},Dn.prototype.registerFilter=function(t,e){this.filters.set(t,e)},Dn.prototype.registerTag=function(t,e){this.tags.set(t,e)},Dn.prototype.plugin=function(t){return t.call(this,Dn)},Dn.prototype.express=function(){var i=this;return function(t,e,r){var n={root:w(W(this.root),i.options.root)};i.renderFile(t,e,n).then(function(t){return r(null,t)},r)}},Dn.prototype.lookupError=function(t,e){var r=new Error("ENOENT");return r.message='ENOENT: Failed to lookup "'+t+'" in "'+e+'"',r.code="ENOENT",r},Dn.prototype.getTemplate=function(e,r){return s(this,void 0,void 0,function(){return D(this,function(t){return[2,this.parseFile(e,r)]})})},Dn.prototype.getTemplateSync=function(t,e){return this.parseFileSync(t,e)},Dn);function Dn(t){var r=this;void 0===t&&(t={}),this.options=function(t){return R({},K,t)}(Q(t)),this.parser=new yr(this),this.renderer=new We,this.filters=new En(this.options.strictFilters,this),this.tags=new qn,l(Zr,function(t,e){return r.registerTag(O(e),t)}),l(On,function(t,e){return r.registerFilter(O(e),t)})}p.AssertionError=ft,p.Context=gt,p.Drop=r,p.Emitter=Ke,p.Expression=Ve,p.Hash=Ge,p.InternalUndefinedVariableError=lt,p.Liquid=Ln,p.LiquidError=$,p.ParseError=et,p.ParseStream=$e,p.RenderError=it,p.TagToken=Fe,p.Token=It,p.TokenizationError=G,p.Tokenizer=He,p.TypeGuards=Ft,p.UndefinedVariableError=at,p.Value=rr,p.assert=de,p.createTrie=U,p.defaultOperators=V,p.evalQuotedToken=Be,p.evalToken=ze,p.isFalsy=C,p.isTruthy=A,p.toPromise=ar,p.toThenable=or,p.toValue=v,Object.defineProperty(p,"__esModule",{value:!0})});
//# sourceMappingURL=liquid.browser.min.js.map
